<!DOCTYPE html>
  <html>
    <head>
      <title>summary</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css">
      
      
      
      
      
      
      
      
      
      

      <style> 
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="1-summary">1. Summary</h1>

<h2 class="mume-header" id="11-c">1.1. C#</h2>

<h3 class="mume-header" id="111-%E9%87%87%E7%94%A8stringformat%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%A5%E6%9C%9F">1.1.1. 采用<code>string.Format</code>格式化日期</h3>

<p>Demo</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token class-name">DateTime</span> dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:y yy yyy yyyy}"</span><span class="token punctuation">,</span>dt<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//17 17 2017 2017</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:M MM MMM MMMM}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4  04 四月 四月</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:d dd ddd dddd}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1  01 周六 星期六</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:t tt}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//下 下午</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:H HH}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//13 13</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:h hh}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1  01</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:m mm}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//16 16</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:s ss}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//32 32</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:F FF FFF FFFF FFFFF FFFFFF FFFFFFF}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1 1  108 108  108   108    108</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:f ff fff ffff fffff ffffff fffffff}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1 10 108 1080 10800 108000 1080000</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:z zz zzz}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//+8 +08 +08:00</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:yyyy/MM/dd HH:mm:ss.fff}"</span><span class="token punctuation">,</span>dt<span class="token punctuation">)</span><span class="token punctuation">;</span>　　<span class="token comment">//2017/04/01 13:16:32.108</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:yyyy/MM/dd dddd}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span>　　　　　　<span class="token comment">//2017/04/01 星期六</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:yyyy/MM/dd dddd tt hh:mm}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2017/04/01 星期六 下午 01:16</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:yyyyMMdd}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span>　　　　　　　　　<span class="token comment">//20170401</span>
<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:yyyy-MM-dd HH:mm:ss.fff}"</span><span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">;</span>　<span class="token comment">//2017-04-01 13:16:32.108</span>
除去<span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>可以对日期进行格式化之外，<span class="token operator">*</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>也可以实现相同的效果：
<span class="token class-name">DateTime</span> dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dt<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"y yy yyy yyyy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//17 17 2017 2017</span>

</pre><h3 class="mume-header" id="112-%E8%BD%AC%E6%8D%A2%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%A4%B1%E8%B4%A5%E5%8F%AF%E6%8C%87%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%80%BC">1.1.2. 转换数据类型，失败可指定默认值</h3>

<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">ToInt32</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token keyword">int</span> defaultValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">value</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             <span class="token keyword">return</span> defaultValue<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">int</span> result<span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">out</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             result <span class="token operator">=</span> defaultValue<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">return</span> result<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="113-c-winform%E7%AA%97%E4%BD%93%E9%97%B4%E4%BC%A0%E5%80%BC">1.1.3. C# winform窗体间传值</h3>

<ol>
<li>方式一： 使用公共静态变量传值</li>
</ol>
<p>主窗体frmMain中代码</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> frmMain <span class="token punctuation">:</span> Form
<span class="token punctuation">{</span>
<span class="token comment">//声明工位ID 为公共静态变量</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">string</span> terminalID <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token comment">//给静态变量赋值</span>
terminalID <span class="token operator">=</span> <span class="token string">"q13bh01-bh12"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>子窗体frmGroup中代码</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"> <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">frmGroup_Load</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txtTerminalID<span class="token punctuation">.</span>Text<span class="token operator">=</span> frmMain<span class="token punctuation">.</span>terminalID<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">//可以再赋值给静态成员，方便其他窗体调用</span>
    frmMain<span class="token punctuation">.</span>terminalID <span class="token operator">=</span> <span class="token string">"q13bh01-bh11"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><blockquote>
<p>特点 ： 双向传值，实现简单<br>
缺点： 静态变量在类加载的时候分配内存，存储于方法区，一般不会被销毁，在系统不够内存情况下会自动回收静态内存，这样就会引起访问全局静态错误。</p>
</blockquote>
<pre class="language-text">2. 使用公共变量传值
主窗体frmMain中代码
</pre>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> frmMain <span class="token punctuation">:</span> Form
    <span class="token punctuation">{</span>
     <span class="token comment">//声明工位ID 为公共变量</span>
     <span class="token keyword">public</span> <span class="token keyword">string</span> terminalID <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token comment">//给变量赋值</span>
    terminalID <span class="token operator">=</span> <span class="token string">"q13bh01-bh12"</span><span class="token punctuation">;</span>
    <span class="token comment">//单击‘行为’按钮的时候会给窗体传值</span>
     <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">btnGroup_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
           <span class="token punctuation">{</span>
               frmGroup frmGro <span class="token operator">=</span> <span class="token keyword">new</span>  <span class="token function">frmGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">//变量传值 ，注意顺序写在ShowDialog()方法之前</span>
                frmGro <span class="token punctuation">.</span>stationID <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>terminalID<span class="token punctuation">;</span>
              frmGro <span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</pre><p>子窗体frmGroup中代码</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">  <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> frmGroup <span class="token punctuation">:</span> Form
  <span class="token punctuation">{</span>
    <span class="token comment">//定义公共属性</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> stationID <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</pre><blockquote>
<p>特点 ： 单向传值，只能主窗体给子窗体传值，实现简单</p>
</blockquote>
<ol start="3">
<li>使用委托传值</li>
</ol>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">   <span class="token keyword">namespace</span> Siemens<span class="token punctuation">.</span>Simatic<span class="token punctuation">.</span>GUIClient<span class="token punctuation">.</span>MESClient
<span class="token punctuation">{</span>
    <span class="token comment">//1、声明一个委托</span>
    <span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token keyword">void</span> <span class="token function">setTextValue</span><span class="token punctuation">(</span><span class="token keyword">string</span> textValue<span class="token punctuation">,</span><span class="token keyword">bool</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> frmGroup <span class="token punctuation">:</span> Form
    <span class="token punctuation">{</span>
        <span class="token comment">//2、声明一个委托类型的事件</span>
         <span class="token keyword">public</span> <span class="token keyword">event</span> setTextValue setFormTextValue<span class="token punctuation">;</span>
         <span class="token keyword">public</span> <span class="token keyword">string</span> groupName <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
         <span class="token keyword">public</span> <span class="token keyword">bool</span> flagBtnGroup <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>  
         <span class="token keyword">public</span> <span class="token function">frmGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
           <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
          <span class="token comment">//轮询‘行为’按钮（相当于按钮单击事件）</span>
          <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">tmrBtn_Tick</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> ButtonX<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">ButtonX</span> butX <span class="token operator">=</span> <span class="token punctuation">(</span>ButtonX<span class="token punctuation">)</span>sender<span class="token punctuation">;</span><span class="token comment">//判断触发事件的是不是Button</span>
                groupName <span class="token operator">=</span> butX<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                flagBtnGroup <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                <span class="token comment">//3、准备要回传的数据。  </span>
                <span class="token function">setFormTextValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>flagBtnGroup <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
</pre><p>主窗体</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">     <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">btnGroup_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            frmGroup frmGro <span class="token operator">=</span> <span class="token keyword">new</span>  <span class="token function">frmGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token comment">//4、初始化事件  </span>
            frmGro <span class="token punctuation">.</span>setFormTextValue <span class="token operator">+</span><span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">setTextValue</span><span class="token punctuation">(</span>frmGro _setFormTextValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//变量传值 ，注意顺序写在ShowDialog()方法之前</span>
            frmGro <span class="token punctuation">.</span>stationID <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>terminalID<span class="token punctuation">;</span>
            frmGro <span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//5、事件具体实现</span>
         <span class="token keyword">public</span> <span class="token keyword">void</span> frmGro <span class="token function">_setFormTextValue</span><span class="token punctuation">(</span><span class="token keyword">string</span> textValue<span class="token punctuation">,</span><span class="token keyword">bool</span> flag<span class="token punctuation">)</span>
        <span class="token punctuation">{</span> 
            <span class="token keyword">this</span><span class="token punctuation">.</span>newGroupName <span class="token operator">=</span> textValue<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>flagBtnGroup <span class="token operator">=</span> flag<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>newGroupName<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                 ……
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="114-winfrom%E6%96%87%E6%9C%AC%E6%A1%86%E4%B8%8D%E8%83%BD%E8%BE%93%E5%85%A5%E4%B8%AD%E6%96%87%E6%88%96%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6">1.1.4. Winfrom文本框不能输入中文或特殊字符</h3>

<p>看一下控件的ImeMode属性是否被设为Disable，如果是，设为NoControl或者On试下Enable IME for the control meMode已经是NoControl了 改成On后是可以输入了 但默认是全角的TextBox.IMEMode 属性 （访问）</p>
<p>语法</p>
<p>表达式。IMEMode</p>
<p>表达式_一个表示文本框对象的变量。</p>
<p>注解</p>
<p>IMEMode属性使用以下设置。</p>
<p>No Control 不设置“日文汉字转换模式”（默认值）。</p>
<p>On 打开“日文汉字转换模式”。</p>
<p>Off 关闭“日文汉字转换模式”。</p>
<p>Disable 禁用“日文汉字转换模式”。</p>
<p>Hiragana 设置全角平假名。</p>
<p>Full pitch Katakana 设置全角片假名。</p>
<p>Half pitch Katakana 设置半角片假名。</p>
<p>Full pitch Alpha/Num 设置全角字母/数字。</p>
<p>Half pitch Alpha/Num 设置半角字母/数字。</p>
<p>HangulFull 设置全角 Hangul。</p>
<p>Hangul 设置半角 Hangul。</p>
<p>当焦点切换到控件通过设置IMEMode属性，可以指定日文汉字转换模式。如果使用了无控制 （默认值），切换到该控件之前焦点设置到组。对于任何其他设置，则使用该控件的日文汉字转换模式设置。例如，如果IMEMode属性设置为 Off，日文汉字转换模式已关闭，而如果IMEMode属性设置为 On，日文汉字转换模式开启。日文汉字转换模式会自动更改每次控件之间移动焦点。</p>
<p>请注意 如果设置为禁用，日文汉字转换模式设置不能更改。如果使用其他任何设置，可以更改日文汉字转换模式，但是当焦点改变时，这些设置都将丢失。如果您想要保存设置，控件失去焦点之前，设置IMEHold/HoldKanjiConversionMode属性。</p>
<h3 class="mume-header" id="115-c-winform-%E8%AF%B7%E6%B1%82http">1.1.5. C# winform 请求http</h3>

<ol>
<li>
<p>通过WebRequest类创建一个HttpWebRequest的对象，该对象可以包含Http请求信息。</p>
</li>
<li>
<p>设置HttpWebRequest对象，其实就是设置Http请求报文的信息内容。</p>
</li>
<li>
<p>从HttpWebRequest对象中获取HttpWebResponse对象，该对象包含Http响应信息。</p>
</li>
<li>
<p>从响应信息中获取响应头信息和响应主体信息。</p>
</li>
</ol>
<blockquote>
<p>POST与GET的差异</p>
</blockquote>
<ol>
<li>
<p>GET是从服务器上获取数据，POST是向服务器传送数据。</p>
</li>
<li>
<p>GET是把参数数据队列加到提交表单的ACTION属性所指的URL中，值和表单内各个字段一一对应，在URL中可以看到。POST是通过HTTPPOST机制，将表单内各个字段与其内容放置在HTML HEADER内一起传送到ACTION属性所指的URL地址。用户看不到这个过程。</p>
</li>
<li>
<p>对于GET方式，服务器端用Request.QueryString获取变量的值，对于POST方式，服务器端用Request.Form获取提交的数据。</p>
</li>
<li>
<p>GET传送的数据量较小，不能大于2KB（这主要是因为受URL长度限制）。POST传送的数据量较大，一般被默认为不受限制。但理论上，限制取决于服务器的处理能力。</p>
</li>
<li>
<p>GET安全性较低，POST安全性较高。因为GET在传输过程，数据被放在请求的URL中，而如今现有的很多服务器、代理服务器或者用户代理都会将请求URL记录到日志文件中，然后放在某个地方，这样就可能会有一些隐私的信息被第三方看到。另外，用户也可以在浏览器上直接看到提交的数据，一些系统内部消息将会一同显示在用户面前。POST的所有操作对用户来说都是不可见的。</p>
</li>
</ol>
<p>get demo</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"> <span class="token comment">/// &lt;summary></span>
        <span class="token comment">/// 获取访问网站时的IP</span>
        <span class="token comment">/// &lt;/summary></span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">GetrequestIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//获取本机外网ip的url</span>
                <span class="token keyword">string</span> getIpUrl <span class="token operator">=</span> <span class="token string">"http://www.ieasn.com/getip.php"</span><span class="token punctuation">;</span> <span class="token comment">//网上获取ip地址的网站</span>
                <span class="token class-name">WebRequest</span> wr <span class="token operator">=</span> WebRequest<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>getIpUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Stream</span> s <span class="token operator">=</span> wr<span class="token punctuation">.</span><span class="token function">GetResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetResponseStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">StreamReader</span> sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StreamReader</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> Encoding<span class="token punctuation">.</span>UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">string</span> all <span class="token operator">=</span> sr<span class="token punctuation">.</span><span class="token function">ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取网站的数据</span>
                GetRequestIP <span class="token operator">=</span> all<span class="token punctuation">;</span>


                sr<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                s<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                GetRequestIP <span class="token operator">=</span> <span class="token string">"获取客户端真实IP失败"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="116-%E6%B5%8F%E8%A7%88%E5%99%A8request-header%E5%92%8Cresponse-header%E7%9A%84%E5%86%85%E5%AE%B9">1.1.6. 浏览器Request Header和Response Header的内容</h3>

<p>1)请求(客户端-&gt;服务端[request])</p>
<pre class="language-text">GET(请求的方式) &#x2F;hello.html(请求的目标资源) HTTP&#x2F;1.1(请求采用的协议和版本号) 

Accept: *&#x2F;*(客户端能接收的资源类型) 

Accept-Language: en-us(客户端接收的语言类型) 

Connection: Keep-Alive(维护客户端和服务端的连接关系) 

Host: localhost:8080(连接的目标主机和端口号) 

Referer: http:&#x2F;&#x2F;localhost&#x2F;links.asp(告诉服务器我来自于哪里) 

User-Agent: Mozilla&#x2F;4.0(客户端版本号的名字) 

Accept-Encoding: gzip, deflate(客户端能接收的压缩数据的类型) 

If-Modified-Since: Tue, 11 Jul 2000 18:23:51 GMT(缓存时间)  

Cookie(客户端暂存服务端的信息) 

Date: Tue, 11 Jul 2000 18:23:51 GMT(客户端请求服务端的时间)
</pre>
<p>2)响应(服务端-&gt;客户端[response])</p>
<pre class="language-text">HTTP&#x2F;1.1(响应采用的协议和版本号) 200(状态码) OK(描述信息)

Location: http:&#x2F;&#x2F;www.baidu.com(服务端需要客户端访问的页面路径) 

Server:apache tomcat(服务端的Web服务端名)

Content-Encoding: gzip(服务端能够发送压缩编码类型) 

Content-Length: 80(服务端发送的压缩数据的长度) 

Content-Language: zh-cn(服务端发送的语言类型) 

Content-Type: text&#x2F;html; charset=GB2312(服务端发送的类型及采用的编码方式)

Last-Modified: Tue, 11 Jul 2000 18:23:51 GMT(服务端对该资源最后修改的时间)

Refresh: 1;url=http:&#x2F;&#x2F;www.ieasn.com&#x2F;getip.php(服务端要求客户端1秒钟后，刷新，然后访问指定的页面路径)

Content-Disposition: attachment; filename=aaa.zip(服务端要求客户端以下载文件的方式打开该文件)

Transfer-Encoding: chunked(分块传递数据到客户端）  

Set-Cookie:SS=Q0=5Lb_nQ; path=&#x2F;search(服务端发送到客户端的暂存数据)

Expires: -1&#x2F;&#x2F;3种(服务端禁止客户端缓存页面数据)

Cache-Control: no-cache(服务端禁止客户端缓存页面数据)  

Pragma: no-cache(服务端禁止客户端缓存页面数据)   

Connection: close(1.0)&#x2F;(1.1)Keep-Alive(维护客户端和服务端的连接关系)
</pre>
<blockquote>
<p>请求头部demo</p>
</blockquote>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">GetResponseHeader</span><span class="token punctuation">(</span><span class="token keyword">string</span> RequestURL<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">string</span> getstate <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> responseHeaders <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> responseHeaderCookies <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">HttpWebRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span>HttpWebRequest<span class="token punctuation">)</span> WebRequest<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>RequestURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">HttpWebResponse</span> response <span class="token operator">=</span> <span class="token punctuation">(</span>HttpWebResponse<span class="token punctuation">)</span> request<span class="token punctuation">.</span><span class="token function">GetResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//协议版本号，状态码，状态描述</span>
                getstate <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0,-20}HTTP/{1} {2:d} {3}"</span><span class="token punctuation">,</span> <span class="token string">"(Status-Line)"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>ProtocolVersion<span class="token punctuation">,</span>
                    response<span class="token punctuation">.</span>StatusCode<span class="token punctuation">,</span> response<span class="token punctuation">.</span>StatusDescription<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//Http response頭</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> response<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>Keys<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    responseHeaders <span class="token operator">+</span><span class="token operator">=</span>
                        <span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0,-20}{1}"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>Keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> c <span class="token keyword">in</span> response<span class="token punctuation">.</span>Cookies<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    responseHeaderCookies <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                responseHeaders <span class="token operator">=</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">finally</span>
            <span class="token punctuation">{</span>
                GetResponseHeaders <span class="token operator">=</span> getstate <span class="token operator">+</span> <span class="token string">"\r\n"</span> <span class="token operator">+</span> responseHeaders <span class="token operator">+</span> <span class="token string">"\r\n"</span> <span class="token operator">+</span> responseHeaderCookies<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

</pre><h3 class="mume-header" id="117-%E8%8E%B7%E5%8F%96%E6%9C%AC%E5%9C%B0%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE">1.1.7. 获取本地网络配置</h3>

<blockquote>
<p><strong>只能获取本地IP，貌似无法获取远程访问IP</strong></p>
</blockquote>
<p><strong>某些电脑中可能存在多个网卡，虚拟网卡，获取所需网络配置时，应适当注意</strong></p>
<p>demo</p>
<pre data-role="codeBlock" data-info="CSharp" class="language-csharp"><span class="token comment">/// &lt;summary></span>
        <span class="token comment">/// 从网卡获取ip设置信息 </span>
        <span class="token comment">/// &lt;/summary></span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">GetIpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">string</span> IPv4Mask <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> IPAddress <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> GatewayAddresses <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> DnsAddresses <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> GetAllDnsInfo <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> IpInfos <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                NetworkInterface<span class="token punctuation">[</span><span class="token punctuation">]</span> nics <span class="token operator">=</span> NetworkInterface<span class="token punctuation">.</span><span class="token function">GetAllNetworkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">NetworkInterface</span> adapter <span class="token keyword">in</span> nics<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">bool</span> Pd1 <span class="token operator">=</span> <span class="token punctuation">(</span>adapter<span class="token punctuation">.</span>NetworkInterfaceType <span class="token operator">==</span> NetworkInterfaceType<span class="token punctuation">.</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//判断是否是以太网连接  </span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>Pd1<span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token class-name">IPInterfaceProperties</span> ip <span class="token operator">=</span> adapter<span class="token punctuation">.</span><span class="token function">GetIPProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//IP配置信息  </span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>ip<span class="token punctuation">.</span>UnicastAddresses<span class="token punctuation">.</span>Count <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ip<span class="token punctuation">.</span>UnicastAddresses<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{</span>
                                IPAddress <span class="token operator">=</span> ip<span class="token punctuation">.</span>UnicastAddresses<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Address<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//IP地址  </span>
                                IPv4Mask <span class="token operator">=</span> ip<span class="token punctuation">.</span>UnicastAddresses<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>IPv4Mask<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//子网掩码  </span>
                                IpInfos <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">"IP地址:"</span> <span class="token operator">+</span> IPAddress <span class="token operator">+</span> <span class="token string">"丨"</span> <span class="token operator">+</span> <span class="token string">"子网掩码:"</span> <span class="token operator">+</span> IPv4Mask <span class="token operator">+</span> <span class="token string">"\r\n"</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>


                        <span class="token keyword">if</span> <span class="token punctuation">(</span>ip<span class="token punctuation">.</span>GatewayAddresses<span class="token punctuation">.</span>Count <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ip<span class="token punctuation">.</span>DnsAddresses<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{</span>
                                DnsAddresses <span class="token operator">+</span><span class="token operator">=</span>ip<span class="token punctuation">.</span>DnsAddresses<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"  "</span><span class="token punctuation">;</span> <span class="token comment">//DNS  </span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ip<span class="token punctuation">.</span>GatewayAddresses<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                            <span class="token punctuation">{</span>
                                
                                GatewayAddresses <span class="token operator">+</span><span class="token operator">=</span> ip<span class="token punctuation">.</span>GatewayAddresses<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Address<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//默认网关  </span>
                            <span class="token punctuation">}</span>


                            GetAllDnsInfo <span class="token operator">=</span> <span class="token string">"默认网关:"</span> <span class="token operator">+</span> GatewayAddresses <span class="token operator">+</span> <span class="token string">"\r\n"</span> <span class="token operator">+</span>
                                            <span class="token string">"DNS:"</span> <span class="token operator">+</span> DnsAddresses <span class="token operator">+</span> <span class="token string">"\r\n"</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                AllNetworkInfo <span class="token operator">=</span> IpInfos <span class="token operator">+</span> GetAllDnsInfo<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="118-%E5%89%AA%E5%88%87%E6%9D%BF">1.1.8. 剪切板</h3>

<p><a href="https://msdn.microsoft.com/zh-cn/library/system.windows.forms.clipboard.aspx">》clipboard类</a></p>
<h3 class="mume-header" id="119-%E6%8E%A7%E4%BB%B6%E6%8B%96%E6%8B%BD">1.1.9. 控件拖拽</h3>

<ol>
<li>
<p>通过DragEnter事件获得被拖入窗口的“信息”(可以是若干文件，一些文字等等)，在DragDrop事件中对“信息”进行解析。</p>
</li>
<li>
<p>接受拖放控件的AllowDrop属性必须设置成true;</p>
</li>
<li>
<p>必须在DragEnter事件中设置好要接受拖放的效果，默认为无效果。(所以单独写DragDrop事件是不会具有拖拽功能的)</p>
</li>
</ol>
<p>demo</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">textBox1_DragEnter</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">DragEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Data<span class="token punctuation">.</span><span class="token function">GetDataPresent</span><span class="token punctuation">(</span>DataFormats<span class="token punctuation">.</span>FileDrop<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span>Effect <span class="token operator">=</span> DragDropEffects<span class="token punctuation">.</span>Link<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Cursor <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Cursors<span class="token punctuation">.</span>Arrow<span class="token punctuation">;</span> <span class="token comment">//指定鼠标形状（更好看）</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span>Effect <span class="token operator">=</span> DragDropEffects<span class="token punctuation">.</span>None<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">textBox1_DragDrop</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">DragEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//GetValue(0) 为第1个文件全路径</span>
    <span class="token comment">//DataFormats 数据的格式，下有多个静态属性都为string型，除FileDrop格式外还有Bitmap,Text,WaveAudio等格式</span>
    <span class="token keyword">string</span> path <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Array<span class="token punctuation">)</span>e<span class="token punctuation">.</span>Data<span class="token punctuation">.</span><span class="token function">GetData</span><span class="token punctuation">(</span>DataFormats<span class="token punctuation">.</span>FileDrop<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    textBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Cursor <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Cursors<span class="token punctuation">.</span>IBeam<span class="token punctuation">;</span> <span class="token comment">//还原鼠标形状</span>
<span class="token punctuation">}</span>

</pre><h3 class="mume-header" id="1110-%E5%AE%9E%E7%8E%B0%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E8%AE%AF">1.1.10. 实现进程间通讯</h3>

<p>用到一个windows api 32函数</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token punctuation">[</span><span class="token class-name">DllImport</span><span class="token punctuation">(</span><span class="token string">"User32.dll"</span><span class="token punctuation">,</span> EntryPoint <span class="token operator">=</span> <span class="token string">"SendMessage"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token keyword">int</span> <span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> wnd<span class="token punctuation">,</span><span class="token keyword">int</span> msg<span class="token punctuation">,</span><span class="token class-name">IntPtr</span> wP<span class="token punctuation">,</span><span class="token class-name">IntPtr</span> lP<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>要有此函数，需要添加命名空间<br>
<code>using System.Runtime.InteropServices;</code></p>
<p>此方法各个参数表示的意义</p>
<p><code>wnd</code>：接收消息的窗口的句柄。如果此参数为HWND_BROADCAST，则消息将被发送到系统中所有顶层窗口，包括无效或不可见的非自身拥有的窗口、被覆盖的窗口和弹出式窗口，但消息不被发送到子窗口。</p>
<p><code>msg</code>：指定被发送的消息类型。</p>
<p><code>wP</code>：消息内容。</p>
<p><code>lP</code>：指定附加的消息指定信息。</p>
<p>用api参考手册查看SendMessage用法时，参考手册则提示</p>
<p>SendMessage与PostMessage之间的区别：SendMessage和PostMessage，这两个函数虽然功能非常相似，都是负责向指定的窗口发送消息<br>
但是SendMessage() 函数发出消息后一直等到接收方的消息响应函数处理完之后才能返回，并能够得到返回值<br>
在此期间发送方程序将被阻塞，SendMessage() 后面的语句不能被继续执行，即是说此方法是同步的。</p>
<p>而PostMessage() 函数在发出消息后马上返回，其后语句能够被立即执行，但是无法获取接收方的消息处理返回值，即是说此方法是异步的。</p>
<h3 class="mume-header" id="1111-%E5%AF%B9%E4%BA%8E%E6%8C%89%E9%94%AE%E7%9A%84%E6%93%8D%E4%BD%9C">1.1.11. 对于按键的操作</h3>

<p>采用keycode</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Event<span class="token punctuation">.</span>WindowsKeyCode <span class="token operator">==</span> <span class="token number">17</span> <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>Event<span class="token punctuation">.</span>WindowsKeyCode <span class="token operator">==</span> <span class="token number">67</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"你按下了ctrl + C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="1112-%E4%B9%A0%E6%83%AF%E7%94%A8trycatch%E6%8D%95%E8%8E%B7%E5%BC%82%E5%B8%B8">1.1.12. 习惯用trycatch捕获异常</h3>

<p>DEMO :</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">try</span>
<span class="token punctuation">{</span>
    FUNCTION
<span class="token punctuation">}</span>
<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
messagebox<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">finally</span>
<span class="token punctuation">{</span>
   FUNCTION
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="1113-%E8%BD%AC%E4%B9%89%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6">1.1.13. 转义特殊字符</h3>

<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">string</span> <span class="token function">TransferStr</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">string</span> str<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"\\\\"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span> <span class="token string">"\\'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//旧→新</span>
    <span class="token punctuation">}</span>
</pre><blockquote>
<p>可多次替换</p>
</blockquote>
<h3 class="mume-header" id="1114-c-%E5%8F%AF%E7%A9%BA%E7%B1%BB%E5%9E%8Bnullable">1.1.14. C# 可空类型（Nullable）</h3>

<p>C# 可空类型（Nullable）C# 单问号 ? 与 双问号 ??</p>
<p>? : 单问号用于对 int,double,bool 等无法直接赋值为 null 的数据类型进行 null 的赋值，意思是这个数据类型是 NullAble 类型的。</p>
<p><code>int? i = 3</code>等同于<code>Nullable&lt;int&gt; i = new Nullable&lt;int&gt;(3);</code></p>
<p><code>int i;</code> //默认值0<br>
<code>int? ii;</code> //默认值null</p>
<p>?? : 双问号 可用于判断一个变量在为 null 时返回一个指定的值。</p>
<p>C# 可空类型（Nullable）C# 提供了一个特殊的数据类型，nullable 类型（可空类型），可空类型可以表示其基础值类型正常范围内的值，再加上一个 null 值。</p>
<p>例如，Nullable&lt; Int32 &gt;，读作&quot;可空的 Int32&quot;，可以被赋值为 -2,147,483,648 到 2,147,483,647 之间的任意值，也可以被赋值为 null 值。类似的，Nullable&lt; bool &gt; 变量可以被赋值为 true 或 false 或 null。</p>
<p>在处理数据库和其他包含可能未赋值的元素的数据类型时，将 null 赋值给数值类型或布尔型的功能特别有用。例如，数据库中的布尔型字段可以存储值 true 或 false，或者，该字段也可以未定义。<br>
声明一个 nullable 类型（可空类型）的语法如下：</p>
<p><code>&lt; data_type&gt; ? &lt;variable_name&gt; = null;</code></p>
<p>Null 合并运算符（ ?? ）Null 合并运算符用于定义可空类型和引用类型的默认值。Null 合并运算符为类型转换定义了一个预设值，以防可空类型的值为 Null。Null 合并运算符把操作数类型隐式转换为另一个可空（或不可空）的值类型的操作数的类型。<br>
如果第一个操作数的值为 null，则运算符返回第二个操作数的值，否则返回第一个操作数的值。下面的实例演示了这点：</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">using</span> System<span class="token punctuation">;</span><span class="token keyword">namespace</span> CalculatorApplication<span class="token punctuation">{</span>
<span class="token keyword">class</span> <span class="token class-name">NullablesAtShow</span>
<span class="token punctuation">{</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">double</span><span class="token operator">?</span> num1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">double</span><span class="token operator">?</span> num2 <span class="token operator">=</span> <span class="token number">3.14157</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> num3<span class="token punctuation">;</span>
num3 <span class="token operator">=</span> num1 <span class="token operator">?</span><span class="token operator">?</span> <span class="token number">5.34</span><span class="token punctuation">;</span> <span class="token comment">// num1 如果为空值则返回 5.34</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"num3 的值： {0}"</span><span class="token punctuation">,</span> num3<span class="token punctuation">)</span><span class="token punctuation">;</span>
num3 <span class="token operator">=</span> num2 <span class="token operator">?</span><span class="token operator">?</span> <span class="token number">5.34</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"num3 的值： {0}"</span><span class="token punctuation">,</span> num3<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="1115-%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E6%8D%95%E8%8E%B7">1.1.15. 全局异常捕获</h3>

<p>1)简单粗暴：在Program.cs使用Try...Catch...</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">现在我们改造Program<span class="token punctuation">.</span>cs里的<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数，改成以下内容：

<span class="token comment">/// &lt;summary></span>
<span class="token comment">/// 应用程序的主入口点。</span>
<span class="token comment">/// &lt;/summary></span>
<span class="token punctuation">[</span><span class="token class-name">STAThread</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span><span class="token function">EnableVisualStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Application<span class="token punctuation">.</span><span class="token function">SetCompatibleTextRenderingDefault</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FrmMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"捕获到未处理异常：{0}\r\n异常信息：{1}\r\n异常堆栈：{2}"</span><span class="token punctuation">,</span> ex<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> ex<span class="token punctuation">.</span>StackTrace<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>2)事件监听：Application.ThreadException</p>
<p>pplication类，这个负责控制整个Windows 程序的运行。</p>
<p>在ThreadException事件上，微软对它的注释是：“在发生未捕获线程异常时发生。”</p>
<p>用try..catch...包住所有代码，当程序异常时将代码将会进入catch块里，处理完成后程序就退出了。</p>
<p>然而在这边我们用Application.ThreadException事件监听并处理后，程序并不会因为异常而退出。可以说是可挽回的异常。</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token comment">//处理未捕获的异常  </span>
Application<span class="token punctuation">.</span><span class="token function">SetUnhandledExceptionMode</span><span class="token punctuation">(</span>UnhandledExceptionMode<span class="token punctuation">.</span>CatchException<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//处理UI线程异常  </span>
Application<span class="token punctuation">.</span>ThreadException <span class="token operator">+</span><span class="token operator">=</span> Application_ThreadException<span class="token punctuation">;</span>
<span class="token comment">//处理非UI线程异常  </span>
AppDomain<span class="token punctuation">.</span>CurrentDomain<span class="token punctuation">.</span>UnhandledException <span class="token operator">+</span><span class="token operator">=</span>CurrentDomain_UnhandledException<span class="token punctuation">;</span>

</pre><pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Application_ThreadException</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">ThreadExceptionEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> ex <span class="token operator">=</span> e<span class="token punctuation">.</span>Exception<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> <span class="token string">"TITLE"</span><span class="token punctuation">,</span> MessageBoxButtons<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxIcon<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">CurrentDomain_UnhandledException</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">UnhandledExceptionEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> ex <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token class-name">ExceptionObject</span> <span class="token keyword">as</span> Exception<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> <span class="token string">"TITLE"</span><span class="token punctuation">,</span> MessageBoxButtons<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxIcon<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="1116-%E5%AF%B9%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%9A%84%E6%93%8D%E4%BD%9C">1.1.16. 对注册表的操作</h3>

<blockquote>
<p>参考 <a href="https://msdn.microsoft.com/zh-cn/library/microsoft.win32.registrykey.aspx">registrykey类</a></p>
</blockquote>
<p><strong>在对应用软件的注册表进行操作时，注意32和64的注册表路径</strong></p>
<p>为了支持 32 位和 64 位 COM 注册和程序状态的共存，WOW64 为 32 位程序提供了一种备用注册表视图。32 位程序会看到与真正的 64 位HKEY_LOCAL_MACHINE\Software树完全分开的 32位<code>HKEY_LOCAL_MACHINE\Software</code>树（<code>HKEY_LOCAL_MACHINE\Software\WOW6432Node</code>)。这样可以隔HKEY_CLASSES_ROOT，因为此树的每个计算机部分驻留在以下注册表项内：<code>HKEY_LOCAL_MACHINE\Software</code>为了通过 COM 和其他机制实现 64 位/32 位程序互操作性，WOW64 使用了一个“注册表反射器”来在 64 位注册表视图和 32 位注册表视图之间镜像某些注册表项和项值。该反射器是“智能”的，因为它只反射 COM 激活数据。</p>
<p>反射的注册表项WOW64 注册表反射器可能会在反射过程中修改注册表项的内容和项值，目的是为了调整路径名等。因此，32 位的内容与 64 位的内容可能会有所不同。下面的注册表项会影射：</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>HKEY_LOCAL_MACHINE\Software\Classes

HKEY_LOCAL_MACHINE\Software\COM3

HKEY_LOCAL_MACHINE\Software\Ole

HKEY_LOCAL_MACHINE\Software\EventSystem

HKEY_LOCAL_MACHINE\Software\RPC
</code></pre><p>注：WoW（Windows on Windows）模式 WOW64 是 Windows-32-on-Windows-64</p>
<h3 class="mume-header" id="1117-win%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BD%ACdll">1.1.17. Win控制台转dll</h3>

<p><a href="https://www.cnblogs.com/lhyqzx/p/5970406.html">调用方法</a></p>
<p>(1) 更加节省内存并减少页面交换；</p>
<p>(2) DLL文件与EXE文件独立，只要输出接口不变（即名称、参数、返回值类型和调用约定不变），更换DLL文件不会对EXE文件造成任何影响，因而极大地提高了可维护性和可扩展性；</p>
<p>(3) 不同编程语言编写的程序只要按照函数调用约定就可以调用同一个DLL函数；</p>
<p>(4)适用于大规模的软件开发，使开发过程独立、耦合度小，便于不同开发者和开发组织之间进行开发和测试。</p>
<p>（5）节约磁盘空间：当应用程序使用动态链接时，多个应用程序可以共享磁盘上单个DLL副本。相比之下，当应用程序使用静态链接库时，每个应用程序要将库代码作为独立的副本链接到可执行镜像中</p>
<h3 class="mume-header" id="1118-%E8%87%AA%E5%AE%9A%E4%B9%89url-protocol-%E5%8D%8F%E8%AE%AEhttp%E8%AE%BF%E9%97%AE%E5%AE%A2%E6%88%B7%E7%AB%AF">1.1.18. 自定义URL Protocol 协议（http访问客户端）</h3>

<p>参考地址：</p>
<p><a href="https://blog.csdn.net/chinahaerbin/article/details/8783024">https://blog.csdn.net/chinahaerbin/article/details/8783024</a><br>
<a href="http://www.cnblogs.com/zjneter/archive/2008/01/08/1030066.html">http://www.cnblogs.com/zjneter/archive/2008/01/08/1030066.html</a><br>
<a href="https://www.cnblogs.com/wang726zq/archive/2012/12/11/UrlProtocol.html">https://www.cnblogs.com/wang726zq/archive/2012/12/11/UrlProtocol.html</a></p>
<p>git参考：<a href="https://github.com/Hawkeyes0/UrlProtocolRegister.git">https://github.com/Hawkeyes0/UrlProtocolRegister.git</a></p>
<p>运行regedit.exe</p>
<p><code>HKEY_CLASSES_ROOT</code>是应用程序运行时必需的信息,<code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</code>是一样的，但是在<code>HKEY_CLASSES_ROOT</code>窗编辑相对来说显得更容易和有条理。</p>
<p><code>HKEY_LOCAL_MACHINE</code>是一个显示控制系统和软件的处理键。HKLM键保存着计算机的系统信息。它包括网络和硬件上所有的软件设置。（比如文件的位置，注册和未注册的状态，版本号等等）这些设置和用户无关，因为这些设置是针对使用这个系统的所有用户的。</p>
<p>HKEY_CLASSES_ROOT\HANRUI\</p>
<p>hanrui://xxxx<br>
注释<br>
协议头<br>
协议参数<br>
Tencent实例</p>
<p><img src="https://i.loli.net/2018/09/12/5b9891a74a8e6.gif" alt="12333.gif"></p>
<h3 class="mume-header" id="1119-graphics-%E7%B1%BB">1.1.19. Graphics 类</h3>

<p><a href="https://msdn.microsoft.com/zh-cn/library/system.drawing.graphics.aspx">参考地址</a></p>
<p>demo:获取分辨率</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">
<span class="token keyword">float</span> dpiX<span class="token punctuation">,</span> dpiY<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
<span class="token class-name">Graphics</span> graphics <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dpiX <span class="token operator">=</span> graphics<span class="token punctuation">.</span>DpiX<span class="token punctuation">;</span>
dpiY <span class="token operator">=</span> graphics<span class="token punctuation">.</span>DpiY<span class="token punctuation">;</span>
x <span class="token operator">=</span> dpiX <span class="token operator">/</span> <span class="token number">96</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> dpiY <span class="token operator">/</span> <span class="token number">96</span><span class="token punctuation">;</span>

</pre><h3 class="mume-header" id="1120-c%E6%89%93%E5%BC%80%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6-%E7%A8%8B%E5%BA%8F">1.1.20. c#打开指定文件、程序</h3>

<p>ex1</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token class-name">Process</span> pr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//声明一个进程类对象</span>
pr<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> <span class="token string">"E://Program Files//Tencent//QQ//QQ.exe"</span><span class="token punctuation">;</span><span class="token comment">//指定运行的程序，我的QQ的物理路径。</span>
pr<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//运行QQ</span>
</pre><p>EX2</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token string">"explorer.exe"</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>EX3</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token comment">//创建启动对象</span>
<span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>ProcessStartInfo</span> startInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置运行文件</span>
startInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>ExecutablePath<span class="token punctuation">;</span>
<span class="token comment">//设置启动参数</span>
startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> Args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置启动动作,确保以管理员身份运行</span>
startInfo<span class="token punctuation">.</span>Verb <span class="token operator">=</span> <span class="token string">"runas"</span><span class="token punctuation">;</span>

</pre><h3 class="mume-header" id="1121-%E4%BB%A5%E7%AE%A1%E7%90%86%E5%91%98%E8%BA%AB%E4%BB%BD%E8%BF%90%E8%A1%8C">1.1.21. 以管理员身份运行</h3>

<p>1、直接在program.cs中添加</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token comment">/// &lt;summary></span>
        <span class="token comment">/// 应用程序的主入口点。</span>
        <span class="token comment">/// &lt;/summary></span>
        <span class="token punctuation">[</span><span class="token class-name">STAThread</span><span class="token punctuation">]</span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> Args<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Args<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"123"</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//获得当前登录的Windows用户标示</span>
                <span class="token class-name">System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Principal<span class="token punctuation">.</span>WindowsIdentity</span> identity <span class="token operator">=</span>
                    System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Principal<span class="token punctuation">.</span>WindowsIdentity<span class="token punctuation">.</span><span class="token function">GetCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Principal<span class="token punctuation">.</span>WindowsPrincipal</span> principal <span class="token operator">=</span>
                    <span class="token keyword">new</span> <span class="token class-name">System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Principal<span class="token punctuation">.</span>WindowsPrincipal</span><span class="token punctuation">(</span>identity<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//判断当前登录用户是否为管理员</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>principal<span class="token punctuation">.</span><span class="token function">IsInRole</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Principal<span class="token punctuation">.</span>WindowsBuiltInRole<span class="token punctuation">.</span>Administrator<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">//如果是管理员，则直接运行</span>
                    Application<span class="token punctuation">.</span><span class="token function">EnableVisualStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Application<span class="token punctuation">.</span><span class="token function">SetCompatibleTextRenderingDefault</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    MainRepairTool<span class="token punctuation">.</span><span class="token function">RepairRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//MessageBox.Show("注册表修复成功！", "title", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);</span>
                    Application<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">try</span>
                    <span class="token punctuation">{</span>
                        <span class="token comment">//创建启动对象</span>
                        <span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>ProcessStartInfo</span> startInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">//设置运行文件</span>
                        startInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> <span class="token string">"aaa.exe"</span><span class="token punctuation">;</span>
                        <span class="token comment">//设置启动参数</span>
                        startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token string">"213"</span><span class="token punctuation">;</span>
                        <span class="token comment">//设置启动动作,确保以管理员身份运行</span>
                        startInfo<span class="token punctuation">.</span>Verb <span class="token operator">=</span> <span class="token string">"runas"</span><span class="token punctuation">;</span>
                        <span class="token comment">//如果不是管理员，则启动UAC</span>
                        System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>startInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">finally</span>
                    <span class="token punctuation">{</span>
                        Application<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                Application<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</pre><p>2、调用app.mainfest</p>
<p>一： 在Visual Studio 中--解决方案资源管理器--右键项目名称--属性，找到“安全性”选项，</p>
<p>二：勾选“启用ClickOnce安全设置”，</p>
<p>三：这时，在项目下面会多出一个“app.manifest”的文件，选中它，并找到代码段<code>&lt;requestedExecutionLevel level=&quot;asInvoker&quot; uiAccess=&quot;false&quot; /&gt;</code>，将其改为：<code>&lt;requestedExecutionLevel level=&quot;requireAdministrator&quot; uiAccess=&quot;false&quot; /&gt;</code></p>
<p>四：改正后，不要急于重新编译生成，再次打开“属性--安全性”界面，<br>
将“启用ClickOnce安全设置”前面的勾去掉后再编译运行。 不然程序会报错无法运行。</p>
<h3 class="mume-header" id="1122-%E6%8E%A7%E4%BB%B6%E9%87%8D%E7%BB%98">1.1.22 控件重绘</h3>

<h2 class="mume-header" id="12-%E5%9F%BA%E4%BA%8Enanui">1.2. 基于NanUI</h2>

<h3 class="mume-header" id="121-nanui%E4%B8%AD%E5%A6%82%E4%BD%95%E8%B0%83%E7%94%A8devtools">1.2.1. NanUI中如何调用devtools</h3>

<blockquote>
<p>可以直接采用获取按键方式调用调试窗口，为避免普通用户使用，可以判断是否在调试状态</p>
</blockquote>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp"><span class="token comment">/// 获取键盘按下的key值</span>
 <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">KeyboardHandler_OnKeyEvent</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">CfxOnKeyEventEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Event<span class="token punctuation">.</span>WindowsKeyCode <span class="token operator">==</span> <span class="token number">123</span><span class="token punctuation">)</span> <span class="token comment">//F12</span>
                <span class="token punctuation">{</span>
                    Chromium<span class="token punctuation">.</span><span class="token function">ShowDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Event<span class="token punctuation">.</span>WindowsKeyCode <span class="token operator">==</span> <span class="token number">116</span><span class="token punctuation">)</span> <span class="token comment">//F5</span>
                <span class="token punctuation">{</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</pre><ol>
<li>
<p>值操作</p>
</li>
<li>
<p><code>SetReturnValue</code></p>
<p><code>CfrV8Value.CreateString</code></p>
</li>
</ol>
<h3 class="mume-header" id="122-%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92">1.2.2. 前后端交互</h3>

<blockquote>
<p>win调用前端</p>
</blockquote>
<p><code>Chromium.ExecuteJavascript(&quot;Comprefresh()&quot;);</code></p>
<p>前端调用Winform</p>
<pre data-role="codeBlock" data-info="CSHARP" class="language-csharp">GlobalObject<span class="token punctuation">.</span><span class="token function">AddFunction</span><span class="token punctuation">(</span><span class="token string">"normalFrm"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Execute <span class="token operator">+</span><span class="token operator">=</span> NormalFrm<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">NormalFrm</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">CfrV8HandlerExecuteEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        WindowState <span class="token operator">=</span> FormWindowState<span class="token punctuation">.</span>Normal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="13-%E5%85%B6%E4%BB%96">1.3. 其他</h2>

<h3 class="mume-header" id="131-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">1.3.1. 正则表达式</h3>

<p>参考http://www.runoob.com/regexp/regexp-tutorial.html</p>
<p>举例：如果我们想要找到字符串The dog chased the cat中单词 the，我们可以使用下面的正则表达式: /the/gi<br>
我们可以把这个正则表达式分成几段：</p>
<p><code>/</code>是这个正则表达式的头部</p>
<p><code>the</code> 是我们想要匹配的模式</p>
<p><code>/</code> 是这个正则表达式的尾部</p>
<p><code>g</code>代表着 global(全局)，意味着返回所有的匹配而不仅仅是第一个。</p>
<p><code>i</code> 代表着忽略大小写，意思是当我们寻找匹配的字符串的时候忽略掉字母的大小写。</p>
<h3 class="mume-header" id="132-keycode%E5%AF%B9%E7%85%A7%E8%A1%A8">1.3.2. Keycode对照表</h3>

<p><img src="https://i.loli.net/2018/09/12/5b98929547572.png" alt="Image.png"></p>

      </div>
      
      
    </body>
    
    
    
    
    
    
    
  </html>